/* =========================================================
 * styles.css — Inventory UI (mobile-first, app-like)
 * Versi perbaikan: konsisten pakai `.items-table`, kolom 操作 sticky,
 * bebas geser kanan-kiri di layar lebar, dan responsif di HP.
 * =======================================================*/

/* ---------- Reset ringan ---------- */
:root{
  --bg:#f6f8fc;
  --card:#ffffff;
  --muted:#6b7280;
  --border:#e5e7eb;
  --primary:#2563eb;
  --danger:#dc2626;
  --success:#16a34a;
  --shadow:0 8px 26px rgba(15,23,42,.06);
  --radius:16px;
  --page-max:1680px;
}

*{ box-sizing:border-box; }
html,body{ height:100%; overflow-x:hidden; }
body{
  margin:0; background:var(--bg); color:#0f172a;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP","Hiragino Kaku Gothic ProN","Meiryo","Helvetica Neue",Arial,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol",sans-serif;
}

/* ---------- Layout umum ---------- */
header.appbar{ background:#fff; border-bottom:1px solid var(--border); position:sticky; top:0; z-index:1020; }
header .brand{ display:flex; align-items:center; gap:.6rem; }
header .brand img{ height:28px; }

.layout{ display:flex; min-height:100vh; gap:0; align-items:stretch; }
.sidebar{
  width:260px; background:#0b1727; color:#c9d2e3; padding:14px; box-shadow:var(--shadow);
}
.sidebar nav a{
  display:flex; align-items:center; gap:.6rem;
  color:#c9d2e3; text-decoration:none; padding:.6rem .7rem; border-radius:10px;
}
.sidebar nav a.active,.sidebar nav a:hover{ background:#142033; color:#fff; }
.sidebar .bi{ font-size:1rem; }

main{ flex:1 1 auto; min-width:0; } /* anti overflow flex */
.content{ padding:16px; }

.app-footer{ margin-top:24px; padding:18px; color:#64748b; text-align:center; }

/* ---------- Cards ---------- */
.card{ background:var(--card); border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow); }
.card .title{ font-weight:600; color:#334155; }

/* ---------- Toolbars ---------- */
.items-toolbar{ display:flex; align-items:center; justify-content:space-between; gap:1rem; }
.items-toolbar .left{ display:flex; align-items:center; gap:.8rem; }
.items-toolbar .right{ display:flex; align-items:center; gap:.6rem; flex-wrap:wrap; }
.items-toolbar .search{ min-width:260px; max-width:360px; }

/* ---------- Buttons ---------- */
.btn{
  display:inline-flex; align-items:center; justify-content:center;
  gap:.45rem; padding:.48rem .7rem; border-radius:10px; cursor:pointer;
  border:1px solid var(--border); background:#fff; color:#0f172a; transition:.15s ease;
}
.btn:hover{ background:#f7f9fe; }
.btn:active{ transform:translateY(1px); }
.btn-primary{ background:var(--primary); color:#fff; border-color:transparent; }
.btn-primary:hover{ filter:brightness(.97); }
.btn-outline-secondary{ background:#fff; }
.btn-danger{ background:var(--danger); color:#fff; border-color:transparent; }
.btn-sm{ padding:.36rem .55rem; border-radius:9px; font-size:.92rem; }
.btn-close{ width:34px; height:34px; border-radius:50%; opacity:.7; }
.btn-close:hover{ opacity:1; }

/* ---------- Forms ---------- */
.form-label{ font-size:.9rem; color:#334155; margin-bottom:.3rem; }
.form-control,.form-select{
  width:100%; padding:.5rem .65rem; border:1px solid var(--border); border-radius:10px;
  background:#fff; color:#0f172a; outline:none;
}
.form-control:focus,.form-select:focus{ border-color:#c7d2fe; box-shadow:0 0 0 4px rgba(99,102,241,.08); }
input[readonly],.form-control[readonly]{ background:#f8fafc; }

/* ---------- Tables (umum) ---------- */
.table{ margin:0; }
.table thead th{
  font-weight:600; color:#334155; background:#f0f3fb;
  border-bottom:1px solid var(--border);
  vertical-align:middle; white-space:nowrap;
}
.table td,.table th{ padding:.6rem .7rem; }
.table tr + tr td{ border-top:1px solid #eef2f7; }
.table-responsive{ overflow-x:auto; }
.table-responsive thead th{ position:sticky; top:0; z-index:1; }

/* ---------- Badges/Chips ---------- */
.badge{ display:inline-block; padding:.25rem .5rem; border-radius:999px; font-size:.78rem; }
.badge-soft{ background:#eef2ff; color:#3730a3; border:1px solid #e0e7ff; }
.badge-danger{ background:#fef2f2; color:#991b1b; border:1px solid #fee2e2; }

/* ---------- Grid aksi kecil (default) ---------- */
.act-grid{ display:grid; grid-template-columns:repeat(4,36px); gap:.35rem; }
.act-grid .btn{ width:36px; height:36px; padding:0; border-radius:10px; }

/* ---------- Chart area ---------- */
.chart-box{ height:260px; }
.chart-card .card-body{ height:360px; }
.chart-card canvas,.chart-box canvas{ width:100% !important; height:100% !important; }

/* ---------- QR box di tabel ---------- */
.tbl-qr-box{
  width:100%; min-width:100px; display:flex; align-items:center; justify-content:center;
  padding:.3rem; background:#f8fafc; border:1px dashed #e5e7eb; border-radius:12px;
}

/* ---------- App loading overlay (global) ---------- */
#global-loading{
  position:fixed; inset:0; z-index:2000; display:flex; align-items:center; justify-content:center;
  background:rgba(255,255,255,.72);
}
#global-loading.d-none{ display:none; }
#global-loading .box{
  display:flex; flex-direction:column; align-items:center; gap:10px;
  padding:16px 18px; background:#fff; border:1px solid #e5e7eb; border-radius:14px; box-shadow:var(--shadow);
}
#global-loading .spinner{ width:28px; height:28px; border-radius:50%; border:3px solid #cbd5e1; border-top-color:var(--primary); animation:spin 1s linear infinite; }
#global-loading .text{ font-size:.95rem; color:#475569; }
@keyframes spin{ to{ transform:rotate(360deg); } }

/* =========================================================
 * Desktop container
 * =======================================================*/
main,.app-main,.content-wrap{ width:100%; }
.container,.container-lg,.container-xl,.container-xxl{ max-width:var(--page-max); }
.container-fluid{ max-width:100%; }
@media (min-width:1400px){ .dashboard-row{ margin-right:0; margin-left:0; } }

/* =========================================================
 * Responsif dasar
 * =======================================================*/

/* Mobile ≤420px */
@media (max-width:420px){
  .layout{ display:block; }
  .items-toolbar{ flex-direction:column; align-items:stretch; gap:.6rem; }
  .items-toolbar .left,.items-toolbar .right{ width:100%; }
  .items-toolbar .search{ width:100%; min-width:0; }
  .table thead th{ font-size:.84rem; }
  .table td{ font-size:.95rem; }
  #scan-area,#io-scan-area{ border-radius:12px; }
  .card{ border-radius:14px; }
}

/* Off-canvas sidebar ≤991px */
@media (max-width:991px){
  .sidebar{
    position:fixed; left:0; top:0; bottom:0;
    width:86%; max-width:360px; background:#0b1727; color:#c9d2e3; overflow:auto;
    transform:translateX(-100%); transition:transform .18s ease-out; z-index:1040;
  }
  body.sb-open .sidebar{ transform:none; }
  #sb-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.35); display:none; z-index:1030; }
  body.sb-open #sb-backdrop{ display:block; }
  .items-toolbar .search{ min-width:240px; }
  .act-grid{ grid-template-columns:repeat(4,44px); gap:.45rem; }
  .act-grid .btn{ width:44px; height:44px; }
  .chart-box{ height:300px; }
}

/* ---------- Icon metric & welcome ---------- */
.ic3d{display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;border-radius:12px;color:#fff;font-size:18px;box-shadow:0 6px 16px rgba(0,0,0,.15),inset 0 1px 0 rgba(255,255,255,.3)}
.ic-blue{background:linear-gradient(135deg,#2f80ed,#56ccf2)}
.ic-red{background:linear-gradient(135deg,#ef476f,#ff6b6b)}
.ic-green{background:linear-gradient(135deg,#06c270,#34d399)}
.ic-violet{background:linear-gradient(135deg,#7c3aed,#a78bfa)}
.metric-head{display:flex;align-items:center;gap:.5rem;color:#6b7280;font-size:.85rem}
.metric-value{font-size:1.9rem;font-weight:700;margin-top:.25rem}

.welcome{background:linear-gradient(135deg,#eef2ff,#f5f7ff);border:1px solid #e5e7eb;border-radius:12px;padding:.65rem .9rem;display:flex;align-items:center;gap:.6rem;box-shadow:0 10px 20px rgba(15,23,42,.04) inset}
.welcome .avatar{width:34px;height:34px;border-radius:10px;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;background:linear-gradient(135deg,#0ea5e9,#22d3ee);box-shadow:0 6px 16px rgba(14,165,233,.25)}

/* ---------- Mobile polish header ≤480px ---------- */
@media (max-width:480px){
  header .brand img{ height:24px; }
  header .brand .fw-bold{ font-size:14px; white-space:nowrap; }
  header.appbar .container-fluid > .d-flex{ flex-wrap:wrap; align-items:center; gap:8px; }
  #who{ display:inline-block; max-width:48vw; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; font-size:.85rem; opacity:.9; }
  header.appbar .btn{ padding:.28rem .5rem !important; font-size:.82rem !important; line-height:1.1; border-radius:10px; white-space:nowrap; }
  header.appbar .btn .bi{ font-size:1rem; }
  #btn-menu{ padding:.25rem .55rem !important; font-size:.82rem !important; border-radius:10px; }
  .content{ padding:12px; }
  .card{ border-radius:14px; }
  #io-scan-area,#scan-area{ max-width:100%; aspect-ratio:3/4; border-radius:10px; overflow:hidden; }
  .section-title{ font-size:1.05rem; line-height:1.25; margin:0; }
  #page-title + #btn-menu{ margin-left:auto; }
}
@media (max-width:360px){ #who{ display:none; } }

/* ---------- Dashboard polish ---------- */
.chart-box{ height:320px; }
@media (min-width:1400px){ .chart-box{ height:360px; } }
@media (max-width:480px){ .chart-box{ height:220px; } }
@media (max-width:480px){
  .card.p-3{ padding:.75rem !important; }
  .metric-head{ font-size:.80rem; }
  .metric-value{ font-size:1.6rem; }
}
@media (min-width:481px) and (max-width:991px){ .metric-value{ font-size:1.8rem; } }
.section-title{ overflow:hidden; text-overflow:ellipsis; white-space:nowrap; max-width:65vw; }
@media (min-width:992px){ .section-title{ max-width:none; } }
#view-dashboard .table-responsive thead th{ position:sticky; top:0; z-index:1; }

/* ---------- Utilities / Patch ---------- */
tr.row-low td{ background:#fff5f5; }
.health-dot{ width:10px; height:10px; border-radius:50%; display:inline-block; margin-right:.4rem; background:#ccc; }
.toast-area{ position:fixed; top:62px; right:12px; z-index:2001; display:flex; flex-direction:column; gap:8px; }
.toast-mini{ background:#111; color:#fff; padding:8px 10px; border-radius:10px; box-shadow:0 10px 26px rgba(0,0,0,.15); font-size:.85rem; }
.skel{ position:relative; overflow:hidden; background:#eef2f7; border-radius:10px; min-height:40px; }
.skel::after{ content:""; position:absolute; inset:0; background:linear-gradient(90deg,transparent,rgba(255,255,255,.55),transparent); animation:sk 1.2s infinite; }
@keyframes sk{ from{transform:translateX(-100%);} to{transform:translateX(100%);} }
#io-scan-area::after,#scan-area::after{ content:""; position:absolute; inset:10%; border:2px dashed rgba(255,255,255,.7); border-radius:12px; pointer-events:none; }
#io-scan-area::before,#scan-area::before{ content:""; position:absolute; left:50%; top:0; bottom:0; width:2px; background:rgba(255,255,255,.6); transform:translateX(-50%); }
.diag-btn{ position:fixed; bottom:18px; right:14px; z-index:2002; }
td.inline-editing{ outline:2px solid #c7d2fe; background:#f8fafc; }
td[data-editable]{ cursor:text; }
#help .accordion-button{ font-weight:600; }
#help .accordion-body{ line-height:1.7; }
#help dl dd{ color:#374151; }

/* =========================================================
 *  商品一覧 — FINAL (konsisten: .items-table)
 * =======================================================*/

/* Gunakan class="table items-table" pada tabel. */
#view-items table.items-table{
  table-layout:fixed;
  width:100%;
}
#view-items table.items-table th,
#view-items table.items-table td{
  vertical-align:middle;
  white-space:nowrap;
  padding:.6rem .7rem;
}

/* Nama item (kolom 3) dipotong elegan */
#view-items .td-name{
  max-width:420px;
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
}

/* Perataan kolom (index kolom):
   [1□][2QR][3コード/名称][4画像][5価格][6在庫][7最小][8部門][9置場][10操作] */
#view-items table.items-table thead th:nth-child(2),
#view-items table.items-table tbody td:nth-child(2), /* QR */
#view-items table.items-table thead th:nth-child(4),
#view-items table.items-table tbody td:nth-child(4){  /* 画像 */
  text-align:center;
}
#view-items table.items-table thead th:nth-child(5),
#view-items table.items-table thead th:nth-child(6),
#view-items table.items-table thead th:nth-child(7),
#view-items table.items-table tbody td:nth-child(5),
#view-items table.items-table tbody td:nth-child(6),
#view-items table.items-table tbody td:nth-child(7){ /* 価格/在庫/最小 */
  text-align:right;
}
#view-items table.items-table thead th:nth-child(3),
#view-items table.items-table tbody td:nth-child(3), /* コード/名称 */
#view-items table.items-table thead th:nth-child(8),
#view-items table.items-table tbody td:nth-child(8), /* 部門 */
#view-items table.items-table thead th:nth-child(9),
#view-items table.items-table tbody td:nth-child(9){ /* 置場 */
  text-align:left;
}

/* Kolom "操作" sticky di kanan*/
#view-items table.items-table thead th:last-child,
#view-items table.items-table tbody td:last-child{
  position:sticky; right:0; background:#fff;
  box-shadow:-8px 0 16px rgba(15,23,42,.06);
  z-index:3; text-align:center;
}

/* Grid tombol 操作 rapat */
/* Desktop default */
#view-items table.items-table td:last-child .act-grid.actions{
  display:grid;
  grid-template-columns:repeat(5,28px);
  gap:6px;
  justify-content:end;
  min-width:160px;
}

#tbl-items .act-grid .btn{
  width:28px; height:28px; padding:0;
  display:inline-grid; place-items:center; border-radius:8px;
}

/* QR kecil proporsional */
#view-items .tbl-qr-box canvas,
#view-items .tbl-qr-box img{ width:64px; height:64px; }

/* Badge warna (opsional cantik) */
#view-items .badge.rounded-pill.text-bg-light{
  background:#fef9c3; color:#854d0e; border:1px solid #fde68a; font-weight:600;
}
#view-items .badge.rounded-pill.bg-body-secondary{
  background:#e0f2fe; color:#0369a1; border:1px solid #bae6fd; font-weight:600;
}

/* ---------- Responsif kolom: sembunyikan bertahap (部門 TETAP TAMPIL) ---------- */
/* Urutan kolom: [□][QR][名称][画像][価格][在庫][最小][部門][置場][操作] */
@media (max-width:1400px){
  /* Sembunyikan dulu LOKASI (置場) saja */
  .items-table thead th:nth-child(9),
  .items-table tbody td:nth-child(9){ /* 置場 */
    display:none;
  }
}
@media (max-width:1200px){
  /* Lalu sembunyikan MIN (最小) */
  .items-table thead th:nth-child(7),
  .items-table tbody td:nth-child(7){ /* 最小 */
    display:none;
  }
}
@media (max-width:992px){
  /* Terakhir, gambar supaya lebih lega di tablet/HP */
  .items-table thead th:nth-child(4),
  .items-table tbody td:nth-child(4){ /* 画像 */
    display:none;
  }
}

@media (max-width:768px){
  .items-table thead th:nth-child(5){ width:90px; } /* 価格 */
  .items-table thead th:nth-child(6){ width:90px; } /* 在庫 */
  #view-items .td-name{ max-width:260px; }
}

/* =========================================================
 * 入出庫（Qty/Type diberi highlight lembut setelah scan）
 * =======================================================*/
#view-io #io-qty,#view-io #io-type{
  background:#fff7ed; border-color:#fdba74; box-shadow:0 0 0 3px rgba(253,186,116,.35);
}
#view-io #io-qty:focus,#view-io #io-type:focus{
  border-color:#f97316; box-shadow:0 0 0 3px rgba(249,115,22,.45);
}

/* =========================================================
 * 棚卸: input & tombol bar bawah di smartphone
 * =======================================================*/
#tbl-stocktake input.st-qty{ text-align:right; }
@media (max-width:576px){
  #tbl-stocktake input.st-qty{ font-size:16px; padding:.25rem .5rem; min-width:72px; height:auto; }
  #view-shelf{ padding-bottom:80px; }
  #view-shelf .st-controls{
    position:fixed; left:0; right:0; bottom:0; z-index:1050;
    padding:.5rem .75rem; background:rgba(255,255,255,.97);
    box-shadow:0 -4px 16px rgba(15,23,42,.18);
    justify-content:space-between; gap:.5rem;
  }
  #view-shelf .st-controls .btn{ flex:1 1 0; font-size:.8rem; padding-top:.4rem; padding-bottom:.4rem; }
}
/* === TOP SCROLLBAR untuk tabel items === */
#items-scroll-top{
  overflow-x: auto;
  overflow-y: hidden;
  height: 12px;
  margin-bottom: 6px;
}
#items-scroll-top > div{ height: 1px; }

/* === Items table: layout & alignment === */
#view-items table.items-table{ table-layout: fixed; width: 100%; }
#view-items table.items-table th,
#view-items table.items-table td{ vertical-align: middle; white-space: nowrap; padding: .6rem .7rem; }

/* Nama item (kolom 3) dipotong elegan */
#view-items .td-name{
  max-width: 420px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}

/* Perataan kolom */
#view-items table.items-table thead th:nth-child(2),
#view-items table.items-table tbody td:nth-child(2), /* QR */
#view-items table.items-table thead th:nth-child(4),
#view-items table.items-table tbody td:nth-child(4){  /* 画像 */
  text-align: center;
}
#view-items table.items-table thead th:nth-child(5),
#view-items table.items-table thead th:nth-child(6),
#view-items table.items-table thead th:nth-child(7),
#view-items table.items-table tbody td:nth-child(5),
#view-items table.items-table tbody td:nth-child(6),
#view-items table.items-table tbody td:nth-child(7){ /* 価格/在庫/最小 */
  text-align: right;
}
#view-items table.items-table thead th:nth-child(3),
#view-items table.items-table tbody td:nth-child(3), /* コード/名称 */
#view-items table.items-table thead th:nth-child(8),
#view-items table.items-table tbody td:nth-child(8), /* 部門 */
#view-items table.items-table thead th:nth-child(9),
#view-items table.items-table tbody td:nth-child(9){ /* 置場 */
  text-align: left;
}

/* Kolom "操作" sticky di kanan */
#view-items table.items-table thead th:last-child,
#view-items table.items-table tbody td:last-child{
  position: sticky; right: 0; background: #fff;
  box-shadow: -8px 0 16px rgba(15,23,42,.06);
  z-index: 3; text-align: center;
}

/* Grid tombol 操作 rapat */
#view-items table.items-table td:last-child .act-grid{
  display: grid; grid-template-columns: repeat(5, 28px); gap: 6px;
  justify-content: end; min-width: 160px;
}
#tbl-items .act-grid .btn{
  width: 28px; height: 28px; padding: 0;
  display: inline-grid; place-items: center; border-radius: 8px;
}

/* QR kecil proporsional */
#view-items .tbl-qr-box canvas,
#view-items .tbl-qr-box img{ width: 64px; height: 64px; }

/* ===== Responsif: SEMBUNYIKAN BERTAHAP (部門 tetap tampil) ===== */
/* Urutan kolom: [□][QR][名称][画像][価格][在庫][最小][部門][置場][操作] */
@media (max-width: 1400px){
  /* Sembunyikan 置場 dulu */
  .items-table thead th:nth-child(9),
  .items-table tbody td:nth-child(9){ display: none; }
}
@media (max-width: 1200px){
  /* Lalu 最小 */
  .items-table thead th:nth-child(7),
  .items-table tbody td:nth-child(7){ display: none; }
}
@media (max-width: 992px){
  /* Terakhir 画像 */
  .items-table thead th:nth-child(4),
  .items-table tbody td:nth-child(4){ display: none; }
}

/* Tablet/HP: kecilkan kolom angka, nama lebih pendek */
@media (max-width: 768px){
  .items-table thead th:nth-child(5){ width: 90px; } /* 価格 */
  .items-table thead th:nth-child(6){ width: 90px; } /* 在庫 */
  #view-items .td-name{ max-width: 260px; }
}

/* Opsional: nama 2 baris di HP kecil */
@media (max-width: 576px){
  #view-items .td-name{
    white-space: normal; display: -webkit-box;
    -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
  }
}
#items-scroll-top{
  height:12px;
  overflow-x:auto; overflow-y:hidden;
  background:#f8fafc;
  border:1px solid var(--border);
  border-radius:8px;
  margin:6px 0 10px;
  position:sticky;
  top:0;
  z-index:5;
}
#items-scroll-top > div{ height:1px; }

/* =========================================================
 *  商品一覧 — FINAL (konsisten: .items-table)
 * =======================================================*/

/* Wrapper scroll horizontal + top scrollbar sinkron (JS: setupTopScrollbar) */
#items-table-wrap{
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}

#items-scroll-top{
  position:sticky;
  top:94px;               /* sesuaikan jika tinggi appbar-mu beda */
  z-index:5;
  height:12px;
  background:#f8fafc;
  border:1px solid var(--border);
  border-radius:8px;
  margin:6px 0 10px;
  overflow-x:auto; 
  overflow-y:hidden;
}
#items-scroll-top > div{ height:1px; }

/* Tabel items */
#view-items table.items-table{
  table-layout:fixed;
  width:100%;
}
#view-items table.items-table th,
#view-items table.items-table td{
  vertical-align:middle;
  white-space:nowrap;
  padding:.6rem .7rem;
}

/* Nama item (kolom 3) potong elegan */
#view-items .td-name{
  max-width:420px;
  overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
}

/* Perataan kolom:
   [1□][2QR][3名称][4画像][5価格][6在庫][7最小][8部門][9置場][10操作] */
#view-items table.items-table thead th:nth-child(2),
#view-items table.items-table tbody td:nth-child(2){ /* QR */
  text-align:center;
}
#view-items table.items-table thead th:nth-child(4),
#view-items table.items-table tbody td:nth-child(4){ /* 画像 */
  text-align:center;
}
#view-items table.items-table thead th:nth-child(5),
#view-items table.items-table thead th:nth-child(6),
#view-items table.items-table thead th:nth-child(7),
#view-items table.items-table tbody td:nth-child(5),
#view-items table.items-table tbody td:nth-child(6),
#view-items table.items-table tbody td:nth-child(7){ /* 価格/在庫/最小 */
  text-align:right;
}
#view-items table.items-table thead th:nth-child(3),
#view-items table.items-table tbody td:nth-child(3), /* 名称 */
#view-items table.items-table thead th:nth-child(8),
#view-items table.items-table tbody td:nth-child(8), /* 部門 */
#view-items table.items-table thead th:nth-child(9),
#view-items table.items-table tbody td:nth-child(9){ /* 置場 */
  text-align:left;
}

/* Kolom "操作" sticky di kanan + rata kanan (bukan center) */
#view-items table.items-table thead th:last-child,
#view-items table.items-table tbody td:last-child{
  position:sticky; right:0; background:#fff;
  box-shadow:-8px 0 16px rgba(15,23,42,.06);
  z-index:3; text-align:right;
}

/* Grid tombol 操作 — desktop default */
#view-items table.items-table td:last-child .act-grid.actions{
  display:grid;
  grid-template-columns:repeat(5,28px);
  gap:6px;
  justify-content:end;
  min-width:160px;
}
#tbl-items .act-grid .btn{
  width:28px; height:28px; padding:0;
  display:inline-grid; place-items:center; border-radius:8px;
}

/* QR kecil proporsional */
#view-items .tbl-qr-box canvas,
#view-items .tbl-qr-box img{
  width:64px; height:64px;
}

/* Chip badge */
#view-items .badge.rounded-pill.text-bg-light{
  background:#fef9c3; color:#854d0e; border:1px solid #fde68a; font-weight:600;
}
#view-items .badge.rounded-pill.bg-body-secondary{
  background:#e0f2fe; color:#0369a1; border:1px solid #bae6fd; font-weight:600;
}

/* Sembunyikan bertahap (部門 tetap tampil) */
@media (max-width:1400px){
  .items-table thead th:nth-child(9),
  .items-table tbody td:nth-child(9){ /* 置場 */
    display:none;
  }
}
@media (max-width:1200px){
  .items-table thead th:nth-child(7),
  .items-table tbody td:nth-child(7){ /* 最小 */
    display:none;
  }
}
@media (max-width:992px){
  .items-table thead th:nth-child(4),
  .items-table tbody td:nth-child(4){ /* 画像 */
    display:none;
  }
}

/* Kompres angka & nama di tablet/HP */
@media (max-width:768px){
  .items-table thead th:nth-child(5){ width:90px; } /* 価格 */
  .items-table thead th:nth-child(6){ width:90px; } /* 在庫 */
  #view-items .td-name{ max-width:260px; }
}

/* HP kecil: tombol 操作 jadi grid 2 kolom, dan sel boleh membungkus */
@media (max-width:576px){
  #view-items td.td-actions{
    white-space:normal;
    min-width:auto !important;   /* override inline JS jika ada */
  }
  #view-items table.items-table thead th:last-child{
    min-width:auto !important;   /* header tidak memaksa lebar */
  }
  #view-items .act-grid.actions{
    grid-template-columns:repeat(2,44px);
    grid-auto-flow:row;
    gap:6px 10px;
    justify-content:end;
  }
  #view-items .act-grid.actions .btn{
    width:44px; height:44px; border-radius:12px;
  }
  /* opsional: judul 2 baris */
  #view-items .td-name{
    white-space:normal; display:-webkit-box;
    -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden;
  }
}
/* ==== Patch HP: kolom 「操作」 jadi 2 kolom rapi ==== */
@media (max-width:576px){
  /* biar sel aksi boleh membungkus & tidak dipaksa lebar oleh JS */
  #view-items td.td-actions{
    white-space: normal;
    min-width: auto !important;
  }

  /* header '操作' juga tidak memaksa lebar & rata kanan */
  #view-items table.items-table thead th:last-child{
    min-width: auto !important;
    text-align: right;
  }

  /* PENTING: pakai selector yang sama spesifiknya dgn aturan desktop */
  #view-items table.items-table td:last-child .act-grid.actions{
    grid-template-columns: repeat(2, 44px) !important; /* 2 kolom */
    grid-auto-flow: row;
    gap: 6px 10px;
    justify-content: end;
  }

  /* ukuran tombol di HP */
  #view-items .act-grid.actions .btn{
    width: 44px; height: 44px; padding: 0; border-radius: 12px;
  }
}
/* ==== Patch HP: kolom 「操作」 jadi 2 kolom rapi ==== */
@media (max-width:576px){
  /* sel terakhir (操作) boleh membungkus & gak dipaksa lebar */
  #view-items table.items-table td:last-child{
    white-space: normal;
    min-width: auto !important;
  }

  /* header '操作' jangan lebar */
  #view-items table.items-table thead th:last-child{
    min-width: auto !important;
    text-align: right;
  }

  /* PENTING: pakai selector yang pasti ada di markup sekarang */
  #view-items table.items-table td:last-child .act-grid{
    grid-template-columns: repeat(2, 44px) !important;  /* 2 kolom */
    grid-auto-flow: row;
    gap: 6px 10px;
    justify-content: end;
  }

  #view-items table.items-table td:last-child .act-grid .btn{
    width: 44px; height: 44px; padding: 0; border-radius: 12px;
  }
}
/* === PATCH: 商品一覧 → kolom 「操作」 jadi 2-grid di layar kecil === */
@media (max-width: 768px) {
  /* 1) Bebaskan lebar yang dipaksa oleh JS (th/td & colgroup) */
  #view-items table.items-table thead th:last-child {
    min-width: auto !important;
    text-align: right;
  }
  #view-items table.items-table td.td-actions {
    min-width: auto !important;
    white-space: normal;         /* boleh membungkus */
  }
  #view-items table.items-table col:last-child {
    width: auto !important;      /* singkirkan width 220px dari colgroup */
  }

  /* 2) Jadikan tombol 2 kolom x n baris (override inline "grid-auto-flow:column") */
  #view-items table.items-table td:last-child .act-grid.actions{
    grid-template-columns: repeat(2, 44px) !important; /* 2 kolom */
    grid-auto-flow: row !important;                     /* isi per baris */
    gap: 6px 10px;
    justify-content: end;
  }
  #view-items .act-grid.actions .btn{
    width: 44px; height: 44px; border-radius: 12px;    /* target nyaman jempol */
  }
}
